//control 2d light
#ifndef Z_AXIS_H
#define Z_AXIS_H
#include <Windows.h> 

using namespace std;

class Z_AXIS
{
private:
	HANDLE hCom;
	char RESET[13] =     { 0x02,0x31,0x30,0x31,0x30,0x30,0x30,0x31,0x30,0x31,0x03,0x42,0x37 };
	char SET_ZERO[13] =  { 0x02,0x31,0x30,0x31,0x30,0x30,0x30,0x31,0x30,0x30,0x03,0x42,0x36 };
	char UP_STEP[13] =   { 0x02,0x31,0x30,0x31,0x30,0x30,0x30,0x31,0x30,0x34,0x03,0x42,0x41 };
	char DOWN_STEP[13] = { 0x02,0x31,0x30,0x31,0x30,0x30,0x30,0x31,0x30,0x32,0x03,0x42,0x38 };

public:
	bool openCOM(LPCWSTR COMstr);
	bool closeCOM(LPCWSTR COMstr);
	int reset_z_axis();
	int move_distance(int distance);
	int write(char* writebuf);
	char* read();
};
#endif
